<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Railway Booking System - Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-content">
            <h1><i class="fa-solid fa-train"></i> Railway System</h1>
            <div id="nav-items">
                <!-- Links MUST point to the new HTML files -->
                <a href="index.html">Search Trains</a>
                <a href="bookings.html">My Bookings</a>
                
                <!-- Admin link visibility determined by JS -->
                <a href="admin_hub.html" id="admin-link" style="display: none;">Admin</a>
                
                <!-- NOTE: Login/Logout links now point to separate authentication pages -->
                <a href="login.html" id="login-btn" class="btn-login" style="display: none;">Login</a>
                <a href="#" id="logout-btn" onclick="logout()" class="btn-login" style="display: none; background-color: #ef4444;">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div class="dashboard-layout">
        
        <!-- Sidebar - User Profile and Navigation -->
        <aside class="sidebar">
            <div class="profile-card">
                <img src="https://placehold.co/60x60/4361ef/ffffff?text=P" onerror="this.onerror=null;this.src='https://placehold.co/60x60/4361ef/ffffff?text=P'" alt="User Profile Picture">
                <h4 id="user-name-display">Welcome, Guest!</h4>
                <p id="user-username-display"></p>
            </div>

            <!-- Main Menu (Passenger View) -->
            <ul class="sidebar-menu">
                <li><a href="passenger_dashboard.html" class="active"><i class="fa-solid fa-chart-line"></i> Dashboard</a></li>
                <li><a href="index.html"><i class="fa-solid fa-magnifying-glass"></i> Search & Book</a></li>
                <li><a href="bookings.html"><i class="fa-solid fa-ticket"></i> My Reservations</a></li>
                <li><a href="feedback_submit.html"><i class="fa-solid fa-star"></i> Submit Feedback</a></li>
                <li style="border-top: 1px solid #e2e8f0; margin-top: 10px; padding-top: 10px;">
                    <a href="#" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> Log Out</a>
                </li>
            </ul>
        </aside>

        <!-- Main Dashboard Content -->
        <main class="dashboard-content">
            
            <h2 class="dashboard-title">Welcome to Your Passenger Hub</h2>
            
            <!-- Quick Action Cards -->
            <div class="action-cards-grid">
                
                <!-- Card 1: Search -->
                <a href="index.html" class="action-card" style="border-top-color: #4895ef;">
                    <div class="card-icon blue"><i class="fa-solid fa-magnifying-glass"></i></div>
                    <h4>Search Trains</h4>
                    <p>Find new routes and check schedules.</p>
                </a>
                
                <!-- Card 2: View Bookings -->
                <a href="bookings.html" class="action-card" style="border-top-color: #b5179e;">
                    <div class="card-icon purple"><i class="fa-solid fa-ticket"></i></div>
                    <h4>My Tickets</h4>
                    <p>View, print, or cancel existing reservations.</p>
                </a>

                <!-- Card 3: Submit Feedback -->
                <a href="feedback_submit.html" class="action-card" style="border-top-color: #f77f00;">
                    <div class="card-icon orange"><i class="fa-solid fa-comment-dots"></i></div>
                    <h4>Give Feedback</h4>
                    <p>Rate your journey and suggest improvements.</p>
                </a>

                <!-- Card 4: View Profile (FIXED LINK) -->
                <a href="profile.html" class="action-card" style="border-top-color: #80b918;">
                    <div class="card-icon green"><i class="fa-solid fa-user-circle"></i></div>
                    <h4>View Profile</h4>
                    <p>Review and update your personal details.</p>
                </a>

            </div>

        </main>
        
    </div>

    <!-- Script tag loads the JavaScript logic -->
    <script src="js/app.js"></script>
    <script>
        // Check local storage on page load and update the page state
        window.onload = function() {
            updateNavbar();
            
            // Redirect to login if user is not authenticated
            const currentUser = localStorage.getItem('railwayUser');
            if (!currentUser) {
                window.location.href = 'login.html';
                return;
            }
            
            // Function to display profile details from app.js
            displayUserProfile(currentUser);

            // Hide Admin link if it's somehow visible on the passenger page
            const adminLink = document.getElementById('admin-link');
            if (adminLink) adminLink.style.display = 'none';
        };
    </script>
</body>
</html>